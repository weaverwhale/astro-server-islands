---
import Layout from '../layouts/Layout.astro';
import { fetchUser } from '../utils/user';
import Counter from '../components/Counter';

interface Props {
	user: any;
}

const userCookie = Astro.cookies.get('user')?.value;
if(!userCookie) return Astro.redirect('/login')
const user = await fetchUser(userCookie);

---

<Layout title="Homepage" user={user}>
	<main>
		<h1 class="text-3xl mb-4">Welcome, {user.name}!</h1>
		<p class="text-2xl">{user.username}</p>
		<p class="text-xl">{user.email}</p>
		<p class="text-lg mb-6">{user.website}</p>
		<img src={`https://maps.googleapis.com/maps/api/staticmap?center=${user.address.geo.lat},${user.address.geo.lng}&zoom=14&size=400x400&key=AIzaSyDhxZAPs4ZM0rvTqeAEewNobc11FBVFxgI`} alt="Map" />
		<Counter count={1} client:visible />
	</main>
</Layout>
